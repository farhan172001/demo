import javax.jms.ConnectionFactory;

import com.ibm.mq.jms.MQQueueConnectionFactory;
import com.ibm.msg.client.wmq.WMQConstants;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.jms.core.JmsTemplate;

@Configuration
public class IbmMqConfig {

    @Value("${mq.host}")
    private String host;

    @Value("${mq.port}")
    private int port;

    @Value("${mq.channel}")
    private String channel;

    @Value("${mq.queueManager}")
    private String queueManager;

    @Value("${mq.username}")
    private String username;

    @Value("${mq.password}")
    private String password;

    @Value("${mq.queueName}")
    private String queueName;

    @Bean
    public ConnectionFactory mqConnectionFactory() throws Exception {
        MQQueueConnectionFactory connectionFactory = new MQQueueConnectionFactory();

        connectionFactory.setHostName(host);
        connectionFactory.setPort(port);
        connectionFactory.setQueueManager(queueManager);
        connectionFactory.setChannel(channel);
        connectionFactory.setTransportType(WMQConstants.WMQ_CM_CLIENT);

        // Authentication (username/password)
        connectionFactory.setStringProperty(WMQConstants.USERID, username);
        connectionFactory.setStringProperty(WMQConstants.PASSWORD, password);

        return connectionFactory;
    }

    @Bean
    public JmsTemplate jmsTemplate(ConnectionFactory mqConnectionFactory) {
        JmsTemplate jmsTemplate = new JmsTemplate(mqConnectionFactory);
        jmsTemplate.setDefaultDestinationName(queueName);
        jmsTemplate.setReceiveTimeout(5000);
        return jmsTemplate;
    }
}





import javax.annotation.PostConstruct;
import javax.jms.*;

import org.springframework.jms.core.JmsTemplate;
import org.springframework.stereotype.Service;

@Service
public class QueueAccessChecker {

    private final JmsTemplate jmsTemplate;

    public QueueAccessChecker(JmsTemplate jmsTemplate) {
        this.jmsTemplate = jmsTemplate;
    }

    @PostConstruct
    public void checkQueueAccess() {
        try {
            System.out.println("üîç Checking MQ Queue Access...");

            // 1. Try to open the queue (session-level)
            Connection connection = jmsTemplate.getConnectionFactory().createConnection();
            connection.start();
            Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);

            Queue queue = session.createQueue(jmsTemplate.getDefaultDestinationName());
            System.out.println("‚úî Queue opened successfully: " + queue.getQueueName());

            // 2. Try to read (non-blocking)
            Message message = jmsTemplate.receive();

            if (message == null) {
                System.out.println("‚úî Queue accessible but no messages available");
            } else {
                System.out.println("‚úî Message received from queue: " + message);
            }

            session.close();
            connection.close();

            System.out.println("‚úî Queue read/open check completed");

        } catch (JMSException e) {
            System.err.println("‚ùå MQ JMS Error: " + e.getMessage());
            e.printStackTrace();

        } catch (Exception ex) {
            ex.printStackTrace();
        }
    }
}





<!-- Spring JMS -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-activemq</artifactId>
</dependency>

<!-- IBM MQ client -->
<dependency>
    <groupId>com.ibm.mq</groupId>
    <artifactId>com.ibm.mq.allclient</artifactId>
    <version>9.3.0.0</version>
</dependency>




<!-- Jakarta JMS API -->
<dependency>
    <groupId>jakarta.jms</groupId>
    <artifactId>jakarta.jms-api</artifactId>
    <version>3.0.0</version>
</dependency>

<!-- IBM MQ Jakarta client (9.x or 10.x, Jakarta compatible) -->
<dependency>
    <groupId>com.ibm.mq</groupId>
    <artifactId>com.ibm.mq.jakarta.client</artifactId>
    <version>9.3.0.0</version>
</dependency>




<dependencies>

    <!-- Spring JMS support -->
    <dependency>
        <groupId>org.springframework</groupId>
        <artifactId>spring-jms</artifactId>
    </dependency>

    <!-- Spring Boot JMS starter without ActiveMQ client -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-activemq</artifactId>
        <exclusions>
            <exclusion>
                <groupId>org.apache.activemq</groupId>
                <artifactId>activemq-client</artifactId>
            </exclusion>
        </exclusions>
    </dependency>

    <!-- IBM MQ Jakarta client (for Spring Boot 3.x) -->
    <dependency>
        <groupId>com.ibm.mq</groupId>
        <artifactId>com.ibm.mq.jakarta.client</artifactId>
        <version>9.3.0.0</version>
    </dependency>

    <!-- Jakarta JMS API (for Spring Boot 3.x) -->
    <dependency>
        <groupId>jakarta.jms</groupId>
        <artifactId>jakarta.jms-api</artifactId>
        <version>3.0.0</version>
    </dependency>

</dependencies>





import com.ibm.mq.jms.MQConnectionFactory;
import com.ibm.msg.client.wmq.WMQConstants;

import javax.jms.*;

public class MQConnectivityCheck {

    // ***** MQ Connection Details *****
    private static final String HOSTNAME = "your.mq.host.com";
    private static final int PORT = 1414;
    private static final String CHANNEL = "PROD.SVRCONN";
    private static final String QUEUE_MANAGER = "QM.PROD";
    private static final String QUEUE_NAME = "APP.INPUT.QUEUE";

    // ***** Credentials *****
    private static final String USERNAME = "mqUser";
    private static final String PASSWORD = "mqPassword";

    // Build connection factory
    public static ConnectionFactory createConnectionFactory() throws JMSException {
        MQConnectionFactory connectionFactory = new MQConnectionFactory();

        connectionFactory.setHostName(HOSTNAME);
        connectionFactory.setPort(PORT);
        connectionFactory.setChannel(CHANNEL);
        connectionFactory.setQueueManager(QUEUE_MANAGER);

        // Mandatory for remote client connection
        connectionFactory.setTransportType(WMQConstants.WMQ_CM_CLIENT);

        // Set user ID and password for MQ v9+ CHLAUTH/authentication
        connectionFactory.setStringProperty(WMQConstants.USERID, USERNAME);
        connectionFactory.setStringProperty(WMQConstants.PASSWORD, PASSWORD);

        return connectionFactory;
    }

    // Test connectivity only
    public static void testMQAccess() {
        Connection connection = null;
        Session session = null;
        MessageProducer producer = null;
        MessageConsumer consumer = null;

        try {
            ConnectionFactory cf = createConnectionFactory();
            System.out.println("Connecting to MQ...");

            // Create connection with credentials
            connection = cf.createConnection(USERNAME, PASSWORD);

            System.out.println("‚úî Connected to Queue Manager: " + QUEUE_MANAGER);

            session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);

            // Try opening the queue
            Queue queue = session.createQueue(QUEUE_NAME);
            MessageProducer mp = session.createProducer(queue);

            System.out.println("‚úî Successfully accessed queue: " + QUEUE_NAME);

        } catch (JMSException e) {
            System.err.println("‚ùå Failed to access MQ: " + e.getMessage());
            e.printStackTrace();
        } finally {
            try { if (session != null) session.close(); } catch (Exception ignored) {}
            try { if (connection != null) connection.close(); } catch (Exception ignored) {}
        }
    }

    public static void main(String[] args) {
        testMQAccess();
    }
}





import com.ibm.mq.jms.MQConnectionFactory;
import com.ibm.msg.client.wmq.WMQConstants;
import jakarta.annotation.PostConstruct;
import org.springframework.stereotype.Component;

import javax.jms.*;

@Component
public class MQConnectivityChecker {

    // MQ details
    private static final String HOSTNAME = "your.host.com";
    private static final int PORT = 1414;
    private static final String CHANNEL = "PROD.SVRCONN";
    private static final String QUEUE_MANAGER = "QM.PROD";
    private static final String QUEUE_NAME = "APP.INPUT.QUEUE";

    private static final String USERNAME = "mqUser";
    private static final String PASSWORD = "mqPassword";

    // Build connection factory
    private ConnectionFactory createConnectionFactory() throws JMSException {
        MQConnectionFactory cf = new MQConnectionFactory();

        cf.setHostName(HOSTNAME);
        cf.setPort(PORT);
        cf.setChannel(CHANNEL);
        cf.setQueueManager(QUEUE_MANAGER);
        cf.setTransportType(WMQConstants.WMQ_CM_CLIENT);

        // Credentials for CHLAUTH
        cf.setStringProperty(WMQConstants.USERID, USERNAME);
        cf.setStringProperty(WMQConstants.PASSWORD, PASSWORD);

        return cf;
    }

    // Auto-run after Spring context loads
    @PostConstruct
    public void verifyMQConnection() {
        Connection connection = null;
        Session session = null;

        System.out.println("üîç Checking MQ connectivity...");

        try {
            ConnectionFactory cf = createConnectionFactory();

            connection = cf.createConnection(USERNAME, PASSWORD);
            System.out.println("‚úî Successfully connected to Queue Manager: " + QUEUE_MANAGER);

            session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);

            Queue queue = session.createQueue(QUEUE_NAME);
            session.createProducer(queue);
            System.out.println("‚úî Successfully accessed Queue: " + QUEUE_NAME);

        } catch (Exception e) {
            System.err.println("‚ùå MQ Connectivity Failed: " + e.getMessage());
            e.printStackTrace();
        } finally {
            try { if (session != null) session.close(); } catch (Exception ignored) {}
            try { if (connection != null) connection.close(); } catch (Exception ignored) {}
        }
    }
}
