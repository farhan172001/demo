@RestController
@RequestMapping("/adhoc")
@RequiredArgsConstructor
public class AdhocController {

    private final DocumentProcessingService documentProcessingService;

    /**
     * Test endpoint to process Base64 PDF + TXT metadata and trigger S3 upload + event.
     * 
     * Example:
     * POST /adhoc/test-document
     */
    @PostMapping("/test-document")
    public ResponseEntity<String> testDocumentProcessing(@RequestBody DocumentRequest request) {

        try {
            documentProcessingService.processDocument(request);
            return ResponseEntity.ok("SUCCESS: Document processed end-to-end.");
        } catch (ApplicationException e) {
            return ResponseEntity.status(HttpStatus.INTERNAL_SERVER_ERROR)
                    .body("FAILED: " + e.getMessage());
        }
    }
}
"GroupNumber, AGC0064216245;GroupName, SYST_WYN22.4.3 Group1; CorrTransact
{
  "metadataFileContent": "GroupNumber, AGC0064216245; GroupName, SYST_WYN22.4.3 Group1; CorrTransactionId, B1",
  "metadataFileName": "metadata.txt",
  
  "dataFileContent": "JVBERi0xLjQKJeLjz9MKNCAwIG9iago8PC9MZW5ndGggNSAwIFIvRmlsdGVyL0ZsYXRlRGVjb2RlPj5zdHJlYW0KeAErKCkpCnN0cmVhbWVuZAplbmRvYmoK",
  "dataFileContentType": "application/pdf",
  "dataFileName": "input.pdf"
}
import software.amazon.awssdk.http.apache.internal.impl.ApacheSdkHttpClientFactory;
import software.amazon.awssdk.http.TlsTrustManagersProvider;

import javax.net.ssl.TrustManager;
import javax.net.ssl.X509TrustManager;
import java.security.cert.X509Certificate;

public class TrustAllTrustManagerProvider implements TlsTrustManagersProvider {

    @Override
    public TrustManager[] trustManagers() {
        return new TrustManager[]{
            new X509TrustManager() {
                public void checkClientTrusted(X509Certificate[] xcs, String string) {}

                public void checkServerTrusted(X509Certificate[] xcs, String string) {}

                public X509Certificate[] getAcceptedIssuers() {
                    return new X509Certificate[0];
                }
            }
        };
    }
}
@Bean
@Primary
public S3Client s3Client() {
    return S3Client.builder()
            .credentialsProvider(DefaultCredentialsProvider.create())
            .region(Region.of(s3Region))
            .httpClientBuilder(
                ApacheHttpClient.builder()
                    .tlsTrustManagersProvider(new TrustAllTrustManagerProvider())
            )
            .build();
}
<dependency>
    <groupId>software.amazon.awssdk</groupId>
    <artifactId>apache-client</artifactId>
</dependency>
<dependency>
    <groupId>software.amazon.awssdk</groupId>
    <artifactId>apache-client</artifactId>
</dependency>
@Bean
@Primary
public S3Client s3Client() {
    // Create a trust manager that accepts all certificates
    TrustManager[] trustAllCerts = new TrustManager[]{
        new X509TrustManager() {
            public X509Certificate[] getAcceptedIssuers() { return new X509Certificate[0]; }
            public void checkClientTrusted(X509Certificate[] certs, String authType) {}
            public void checkServerTrusted(X509Certificate[] certs, String authType) {}
        }
    };

    try {
        SSLContext sslContext = SSLContext.getInstance("TLS");
        sslContext.init(null, trustAllCerts, new SecureRandom());
        
        SdkHttpClient httpClient = ApacheHttpClient.builder()
            .tlsTrustManagersProvider(() -> trustAllCerts)
            .build();

        return S3Client.builder()
            .credentialsProvider(DefaultCredentialsProvider.create())
            .region(Region.US_EAST_1)
            .httpClient(httpClient)
            .build();
    } catch (Exception e) {
        throw new RuntimeException("Failed to create S3Client", e);
    }
}
@Operation(summary = "Upload a file to S3")
    @PostMapping(value = "/upload", consumes = "multipart/form-data")
    public ResponseEntity<String> uploadFile(
            @Parameter(
                    description = "File to upload",
                    content = @Content(mediaType = "multipart/form-data")
            )
            @RequestParam("file") MultipartFile file
    ) throws IOException {

        // ðŸ”¥ Directly writing service logic inside controller
        s3Client.putObject(
                PutObjectRequest.builder()
                        .bucket(bucketName)
                        .key(file.getOriginalFilename())
                        .build(),
                RequestBody.fromBytes(file.getBytes())
        );

        return ResponseEntity.ok("File uploaded successfully!");
    }
