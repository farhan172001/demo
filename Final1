private String resolveContentType(String fileName) {
    String lower = fileName.toLowerCase();

    if (lower.endsWith(".pdf")) {
        return "application/pdf";
    }

    if (lower.endsWith(".txt")) {
        return "text/plain";
    }

    // default fallback
    return "application/octet-stream";
}
private String resolveContentType(String fileName) throws S3OperationException {
    String lower = fileName.toLowerCase();

    if (lower.endsWith(".pdf")) {
        return "application/pdf";
    }
    if (lower.endsWith(".txt")) {
        return "text/plain";
    }

    // ‚ùå Unsupported file type
    throw new S3OperationException(
            "Unsupported file format. Only PDF and TXT files are allowed: " + fileName
    );
}
